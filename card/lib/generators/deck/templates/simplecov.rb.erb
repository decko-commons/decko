
if ENV["TMPSETS"] && ENV["COVERAGE"] != "false"
  SimpleCov.start do
    def add_mod_groups dir_pattern
      Dir[dir_pattern].each do |path|
        modname = File.basename path
        add_group "Mod: #{modname}", %r{(mod/|mod\d{3}-)#{modname}}
      end
    end
    <% if platypus? %>
    root "<%= expanded_repo_path %>"

    add_filter "/generators/"
    add_filter "_spec_helper"
    add_filter "test_seed"

    add_group "Card", "card/"
    add_group "Cardname", "cardname"
    add_group "Decko", "decko"

    add_mod_groups "#{root}/{card/,}/mod/*"
    <% else %>
    add_mod_groups "mod/*"
    <% end %>
    add_filter "/spec/"
    add_filter "/features/"
    add_filter "/config/"
    add_filter "/tasks/"
  end
end
